<div class="page-centered">
  <mat-card class="create-card app-card">
    <mat-card-header>
      <mat-card-title>Add a new boardgame</mat-card-title>
    </mat-card-header>

    <form [formGroup]="form" (ngSubmit)="processFormSubmission()">
      <mat-form-field appearance="fill">
        <mat-label>Game name</mat-label>
        <input matInput formControlName="name" placeholder="Es. Wingspan" />
        @if (form.controls.name.hasError('required')) {
        <mat-error>The name is required</mat-error>
        }
      </mat-form-field>

      <div class="row-group">
        <mat-form-field appearance="fill">
          <mat-label>Min Players</mat-label>
          <input matInput type="number" formControlName="minPlayers" min="1" />
          @if (form.controls.minPlayers.hasError('min')) {
          <mat-error>You need to enter at least 1 player</mat-error>
          }
        </mat-form-field>

        <mat-form-field appearance="fill">
          <mat-label>Max Players</mat-label>
          <input matInput type="number" formControlName="maxPlayers" min="1" />
          @if (form.controls.maxPlayers.hasError('min')) {
          <mat-error>You need to enter at least 1 player</mat-error>
          }
        </mat-form-field>
      </div>

      @if (form.hasError('minGreaterThanMax') && (form.controls.minPlayers.touched ||
      form.controls.maxPlayers.touched)) {
      <mat-error class="group-error">
        The minimum number of players cannot be greater than the maximum.
      </mat-error>
      }

      <mat-form-field appearance="fill">
        <mat-label>Times per Player</mat-label>
        <input matInput type="number" formControlName="minutesPerPlayer" placeholder="30" />
        <span matTextSuffix>min</span>
        @if (form.controls.minutesPerPlayer.hasError('required')) {
        <mat-error>Time is required</mat-error>
        }
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Cover image URL</mat-label>
        <input matInput formControlName="coverUrl" placeholder="https://..." />

        @if (form.controls.coverUrl.hasError('required')) {
        <mat-error>URL is required</mat-error>
        } @else if (form.controls.coverUrl.hasError('pattern')) {
        <mat-error>Enter a valid URL</mat-error>
        }
      </mat-form-field>

      <app-form-alert [message]="errorMessage()" />

      <div class="actions">
        <button mat-button type="button" routerLink="/dashboard/association">Cancel</button>
        <app-submit-button
          [isLoading]="isSubmitting()"
          [isDisabled]="form.invalid"
          loadingText="Saving..."
        >
          Add Game
        </app-submit-button>
      </div>
    </form>
  </mat-card>
</div>
